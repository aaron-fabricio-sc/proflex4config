/**
 @preserve
 Copyright (c) 2001-2020 by Wincor Nixdorf International GmbH,
 Heinz-Nixdorf-Ring 1, 33106 Paderborn, Germany

 This software is the confidential and proprietary information
 of Diebold Nixdorf.
 You shall not disclose such Confidential Information and shall
 use it only in accordance with the terms of the license agreement
 you entered into with Diebold Nixdorf.


$MOD$ Calculations.js 4.3.1-201130-21-086c3328-1a04bc7d
 */
if("undefined"!=typeof importScripts){importScripts("../../../lib/require.js");let t=new DenomValidator;require({baseUrl:"./"},["require"],(e=>(self.onmessage=e=>{let s=e.data,o={distribution:t.doAlgo(s)};o.distribution.algoResult=null,self.postMessage(o)},self.postMessage("READY_FOR_ACTION"),t)))}else define([],(()=>{"use strict";return new DenomValidator}));function DenomValidator(){const t=2147483647,e=-2147483648,s=Number.MAX_VALUE,o={values:[],itemSlots:[],itemTypes:[],solutions:[],allSolutions:[],isSolutionFound:!1,distributions:[],amount:0,pos:0,neg:0,tries:0,maxTries:0,maxItems:0,maxNotes:0,maxCoins:0,numberCandidates:0,bestIdx:0,bestScore:0,isAbortAfterFirstHit:!1,algoMode:0,algoResult:null};function i(t,e,s,n){if(s<=0)return 0;let r=0,u=Math.min(o.itemSlots[e],t),a=s/o.values[e];a=Math.floor(a),n[e]=Math.min(a,u);let f=s-n[e]*o.values[e];if(0===f){if(r=1,l(n,o.values,o.itemSlots,1)&&(o.allSolutions.push(n.concat([])),o.algoResult&&o.algoResult.result(e,n)),o.isAbortAfterFirstHit)return r}else{o.pos>f&&(o.pos=f);let t=f-o.values[e];n[e]<u&&t<0&&o.neg<t&&(o.neg=t)}if(e<=1)return r;for(;n[e]>=0;n[e]--,f=o.values[e]+f){if(r=i(t-n[e],e-1,f,n)+r,!o.isAbortAfterFirstHit&&++o.tries>o.maxTries)return r;if(o.isAbortAfterFirstHit&&r||++o.tries>o.maxTries)return r}return r}function l(t,e,s,i){let l=0,n=0,r=0,u=!0;for(let a=t.length-1;a>=i&&u;a--)l=t[a]*e[a]+l,u=t[a]<=s[a],0===o.itemTypes[a-i]?n=t[a]+n:r=t[a]+r;return u&&l===o.amount&&n<=o.maxNotes&&r<=o.maxCoins}function n(t,e){let s=0;for(let e=1;e<t.length-1;e++)s=Math.abs(t[e]-t[e+1])+s;s<o.bestScore&&(o.bestIdx=e,o.bestScore=s)}function r(t=0,e=[],s=[],o={}){let i=new Array(e.length).fill(0),n=Math.min(e.length,s.length);this.values=e,this.counts=s,this.amount=t,this.getResult=()=>{for(let t=0;t<n;t++)i[t]=0;return i.shift(),i},this.isValid=()=>l(i,this.values,this.counts,1),this.result=o.result,o.algoResult=this,this.better=(t,e=[])=>{for(let s=0;s<e.length-t;s++)i[t+s]=e[t+s];n=t}}function u(){let e=t;this.algoResult=null,this.result=(t,s=[])=>{let o=0;for(let e=t;e<s.length;e++)o=s[e]+o;o<e&&(e=o,this.algoResult.better(t,s))}}function a(){let e=t;this.algoResult=null,this.result=(t,s=[])=>{let o=0;for(let t=1;t<s.length-1;t++)o=Math.abs(s[t]-s[t+1])+o;o<e&&(e=1===o?e:o,this.algoResult.better(t,s))}}function f(){let t=0;this.algoResult=null,this.result=(e,o=[])=>{let i,l=s,n=this.algoResult.counts;for(let t=e;t<o.length;t++)o[t]>0&&(i=n[t]/o[t],i<l&&(l=i));l>t&&(t=l,this.algoResult.better(e,o))}}function h(){let e=0,s=t;this.algoResult=null,this.result=(t,o=[])=>{let i=0,l=0;for(let e=t;e<o.length;e++)l=o[e]+l,o[e]>0&&i++;(i>e||i===e&&l<s)&&(e=i,s=l,this.algoResult.better(t,o))}}function g(){let s=e,o=t;this.algoResult=null,this.result=(t,e=[])=>{const i=.66*this.algoResult.amount;let l=this.algoResult.values,n=l.length,r=-n,u=0,a=!1,f=!0;for(let s=t;s<e.length;s++){if(u=e[s]+u,e[s]>0&&r++,e[s]*l[s]>i){f=!1;break}1===e[s]&&l[s]>i&&(a=!0)}!a&&f&&(r=n+r),(r>s||r===s&&u<o)&&(s=r,o=u,this.algoResult.better(t,e))}}function m(){let t=-1;this.algoResult=null,this.result=(e,s=[])=>{const o=.66*this.algoResult.amount;let i=0,l=this.algoResult.values;for(let t=e;t<s.length;t++)s[t]*l[t]<=o&&i++;i>t&&(t=i,this.algoResult.better(e,s))}}function S(){this.algoResult=null,this.result=(t,e=[])=>{this.algoResult.better(t,e)}}return{ALGO_MODE:{SPLIT_DISTRIBUTIONS:0,RAW_DISTRIBUTIONS:1,FREE:2,FIRST_HIT_ONLY:3},ALGO_EVALUATORS:{BIG_ITEMS:0,BALANCED_ITEMS:1,BALANCED_CASSETTES:2,MANY_CASSETTES:3,MANY_CASSETTES_66:4,SIXTY_SIX_PERCENT:5,DEFAULT:6},denom:function(s){if(o.values=[0].concat(s.items),o.itemSlots=[0].concat(s.counts),o.amount=s.amount,o.solutions=[],o.allSolutions=[],o.pos=t,o.neg=e,o.maxTries=s.maxTries,o.tries=0,o.maxItems=s.maxItems,o.algoResult=new r(o.amount,o.values,o.itemSlots,function(t,e){let s;switch(e){case t.BIG_ITEMS:s=new u;break;case t.BALANCED_ITEMS:s=new a;break;case t.BALANCED_CASSETTES:s=new f;break;case t.MANY_CASSETTES:s=new h;break;case t.MANY_CASSETTES_66:s=new g;break;case t.SIXTY_SIX_PERCENT:s=new m;break;case t.DEFAULT:s=new S;break;default:s=new S}return s}(this.ALGO_EVALUATORS,s.algoEvaluator)),!o.maxItems){o.maxItems=0;for(let t=o.itemSlots.length-1;t>=1;t--)o.maxItems=o.itemSlots[t]+o.maxItems}return o.solutions=new Array(o.values.length).fill(0),o.numberCandidates=i(o.maxItems,o.values.length-1,o.amount,o.solutions),o.solutions[0]=o.numberCandidates,o},nextLower:function(){return o.numberCandidates>0?o.amount:o.pos===Number.MAX_VALUE?0:o.amount-o.pos},nextHigher:function(){return o.numberCandidates>0?o.amount:o.neg===Number.MIN_VALUE?0:o.amount-o.neg},doAlgo:function(t){let e,s=[];if(t.splitMode=t.splitMode||t.algoMode===this.ALGO_MODE.SPLIT_DISTRIBUTIONS,o.isAbortAfterFirstHit=t.isAbortAfterFirstHit||t.algoMode===this.ALGO_MODE.FIRST_HIT_ONLY,o.distributions=[],o.itemTypes=t.types,o.maxNotes=t.maxNotes,o.maxCoins=t.maxCoins,o.isSolutionFound=!1,o.algoMode=t.algoMode,void 0===o.algoMode&&(o.algoMode=t.splitMode?this.ALGO_MODE.SPLIT_DISTRIBUTIONS:this.ALGO_MODE.FREE),o.isAbortAfterFirstHit&&o.algoMode===this.ALGO_MODE.FIRST_HIT_ONLY)this.denom(t),o.allSolutions.length>0?o.allSolutions[0].shift():o.allSolutions[0],o.isSolutionFound=1===o.solutions[0],o.solutions.shift(),o.distributions[0]=o.solutions;else{this.denom(t);let i=o.allSolutions;const r=i.length;if(r>0)if(o.isSolutionFound=!0,o.bestIdx=r-1,o.bestScore=1e3,o.algoMode===this.ALGO_MODE.SPLIT_DISTRIBUTIONS&&r<t.minResultsForSplitMode&&(o.algoMode=this.ALGO_MODE.RAW_DISTRIBUTIONS),o.algoMode===this.ALGO_MODE.SPLIT_DISTRIBUTIONS){for(e=r-1;e>=0;e--)n(i[e],e);o.allSolutions=[],s=i[o.bestIdx].concat([]),s.shift(),function(t,e,s,i){let n=e.length,r=0,u=0;function a(t,s,o){let i,l=[];for(i=t+1;i<n;i++)e[i]%o==0&&e[i]/o<=s[t]&&l.push({value:e[i],count:s[i]});let r=l[0];for(i=0;i<l.length;i++)l[i].count<r.count&&(r=l[i]);return r.value}function f(t,s){let o,i,l=e[t];for(let r=t;r<n;r++){if(o=e[r+1],i=void 0!==e[r+2]?e[r+2]:-1,o%l==0&&o/l<=s[t])return o=a(t,s,l),{higher:o,upper:-1};if(-1!==i&&s[t]*l+s[t+1]*o===i)return{higher:-1,upper:i}}return{higher:-1,upper:-1}}function h(t,s){let o,i,l=e[t];for(let n=t;n>=0;n--){if(o=e[n-1],i=void 0!==e[n-2]?e[n-2]:-1,l%o==0&&s[t]>0)return{lower:o,moreLower:-1};if(-1!==i&&s[t]>0&&2*o+i===l)return{lower:o,moreLower:i}}return{lower:-1,moreLower:-1}}function g(t){let s,o,i,l,n,u=t.length-1,a=0;for(let h=r;h<=u;h++)if(s=e[h],l=f(h,t),o=l.higher,i=l.upper,-1!==o){if(a=0,n=e.indexOf(o),t[h]>1&&o%s==0&&o/s<=t[h])return t[h]-=o/s,t[n]++,r=r<u?++r:0,t}else{if(-1!==i&&t[h]*s+t[h+1]*e[h+1]===i)return t[h]=t[h+1]=0,t[h+2]++,t;if(a>=2)break;r=r<u?++r:0,0===r&&h===u&&(h=-1,a++)}return-1}function m(s){let o,i,l,n,u,a=s.length-1,f=0;for(let g=a-r;g>=0;g--)if(i=e[g],l=h(g,s),o=l.lower,n=l.moreLower,-1!==o&&-1===n){if(f=0,u=e.indexOf(o),s[g]>=1&&i%o==0&&s[u]+i/o<=t)return s[g]--,s[u]+=i/o,r=r<a?++r:0,s}else{if(-1!==o&&-1!==n&&2*o+n===i)return s[g]--,s[e.indexOf(o)]+=2,s[e.indexOf(n)]++,s;if(f>=2)break;r=r<a?++r:0,0===r&&(g=a+1,f++)}return-1}o.distributions[0]=i;let S=[].concat(i);for(;-1!==S;)S=g(S),-1!==S&&l(S,e,s,0)&&(u++,o.distributions[u]=[].concat(S));for(u=0,S=[].concat(i);-1!==S;)S=m(S),-1!==S&&l(S,e,s,0)&&(u--,o.distributions[u]=[].concat(S))}(o.maxItems,t.items,t.counts,s);let u=i[0].concat([]);u.shift(),function(t){let e=0,s=t.length,i=!1;for(;o.distributions[e];){i=!0;for(let l=s-1;l>=0;l--)if(o.distributions[e][l]!==t[l]){i=!1;break}if(e++,i)break}return i}(u)||(o.distributions[o.distributions.length]=u)}else if(o.algoMode===this.ALGO_MODE.RAW_DISTRIBUTIONS){for(e=r-1;e>=0;e--)n(i[e],e);const t=o.bestIdx;for(o.allSolutions=[],o.distributions[0]=i[t].concat([]),o.distributions[0].shift(),e=r-1;e>t;e--)o.distributions[-(e-t)]=i[e].concat([]),o.distributions[-(e-t)].shift();for(e=t-1;e>=0;e--)o.distributions[t-e]=i[e].concat([]),o.distributions[t-e].shift()}else if(o.algoMode===this.ALGO_MODE.FREE){o.allSolutions=[],o.isSolutionFound=o.algoResult.isValid();let t=o.algoResult.getResult();o.solutions.shift(),o.distributions[0]=t}}return o}}}